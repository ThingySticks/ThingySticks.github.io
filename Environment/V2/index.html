<!doctype html>
<html lang="en">
 <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Internet of Things Environmental Sensors for the Particle Photon or Electron. Measures Temperature, Humidity, Pressure and Light levels.">

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

	<meta charset="UTF-8">  
	<title>ThingySticks - Environment (Temperature, Humidity, Light and Pressure) Monitoring</title>

	<!-- Custom CSS -->
    <link href="../../css/round-about.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

	<link rel="icon" href="../../favicon32.png" sizes="32x32" type="image/png">  
	<link rel="icon" href="../../favicon62.png" sizes="62x62" type="image/png">  
	<link rel="icon" href="../../favicon192.png" sizes="192x192" type="image/png">  

	<meta property="og:url" content="http://ThingySticks.com/Environment/V2">
	<meta property="og:type" content="website">
	<meta property="og:title" content="Environmental Sensor ThingySticks">
	<meta property="og:image" content="http://ThingySticks.com/Environment/V2/Images/PhotonEnvironmentThingyStick1.jpg">
	<meta property="og:description" content="Internet connected environmental sensors. Measure Temperature, Humidity, Pressure and Light levels.">
	<meta property="og:site_name" content="ThingySticks">

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-89870513-1', 'auto');
	  ga('send', 'pageview');

	</script>
 </head>

 <body>
 <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">ThingySticks</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="https://github.com/ThingySticks" target="_blank" alt="ThingySticks GitHub Repositories">GitHub</a>
                    </li>
					<li>
                        <a href="https://Tinamous.com" target="_blank" alt="Tinamous.com IoT Platform">Tinamous.com</a>
                    </li>
				</ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

	<!-- Page Content -->
    <div class="container">

        <!-- Introduction Row -->
        <div class="row">
            <div class="col-xs-11 col-sm-7 col-xs-offset-1">
				<h1 class="page-header">Environment Monitoring</h1>
                <p>Measure Temperature, Humidity, Light and Pressure with the <a href="https://Particle.io" target="_blank">Particle</a> <a href="https://www.particle.io/products/hardware/photon-wifi-dev-kit" target="_blank">Photon</a> or <a href="https://www.particle.io/products/hardware/electron-cellular-dev-kit" target="_blank">Electron</a>.</p>
            </div>
			<div class="col-xs-11 col-sm-2 col-xs-offset-1 col-sm-offset-1">
				<div class="pull-right" style="margin:40px 0 20px">
					<a href="https://www.tindie.com/products/ThingySticks/environment-sensor-for-the-photon-or-electron/" class="btn btn-success btn-lg">Buy now on Tindie</a>
				</div>
			</div>
        </div>

        <!-- Images -->
        <div class="row">
			<div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="">

				<!-- Indicators -->
				<ol class="carousel-indicators">
					<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
					<li data-target="#myCarousel" data-slide-to="1"></li>
					<li data-target="#myCarousel" data-slide-to="2"></li>
					<li data-target="#myCarousel" data-slide-to="3"></li>
					<li data-target="#myCarousel" data-slide-to="4"></li>
				</ol>

				<!-- Wrapper for slides -->
				<div class="carousel-inner" role="listbox">
					<div class="item active">
						<a href="Images/PhotonWithLed.jpg">
							<img class="img-responsive img-center" src="Images/PhotonWithLed.jpg" alt="Environment sensor with Photon">
						</a>	
					</div>

					<div class="item">
						<a href="Images/ElectronOnAssetTracker.jpg">
							<img class="img-responsive img-center" src="Images/ElectronOnAssetTracker.jpg" alt="Environment sensor with Electron on the Asset Tracker">
						</a>	
					</div>

					<div class="item">
						<a href="Images/LightHumidityPressure.jpg">
							<img class="img-responsive img-center" src="Images/LightHumidityPressure.jpg" alt="Light, humidity and pressure monitoring with Tinamous.com">
						</a>	
					</div>

					<div class="item">
						<a href="Images/TempertureAndHumidity.jpg">
							<img class="img-responsive img-center" src="Images/TempertureAndHumidity.jpg" alt="Temperature and pressure monitoring on Tinamous.com">
						</a>	
					</div>

					<div class="item">
						<a href="Images/PhotonInUSBStrip.jpg">
							<img class="img-responsive img-center" src="Images/PhotonInUSBStrip.jpg" alt="With a Photon in the USB outlet">
						</a>	
					</div>

					<div class="item">
						<a href="Images/PcbTop.png">
							<img class="img-responsive img-center" src="Images/PcbTop.png" alt="PCB Top">
						</a>	
					</div>

					<div class="item">
						<a href="Images/PcbBottom.png">
							<img class="img-responsive img-center" src="Images/PcbBottom.png" alt="PCB Bottom">
						</a>	
					</div>

					<div class="item">
						<a href="Images/PcbTopDesign.png">
							<img class="img-responsive img-center" src="Images/PcbTopDesign.png" alt="PCB Top">
						</a>	
					</div>

					<div class="item">
						<a href="Images/PcbBottomDesign.png">
							<img class="img-responsive img-center" src="Images/PcbBottomDesign.png" alt="PCB Bottom">
						</a>	
					</div>


				</div>

				<!-- Left and right controls -->
				<a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
					<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
					<span class="sr-only">Previous</span>
				</a>
				<a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
					<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
					<span class="sr-only">Next</span>
				</a>
			</div>
		</div>

		<!-- Features -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">Features</h2>
				<p>
					<ul>
						<li>Ambient Light Sensor</li>
						<li>Temperature Sensor</li>
						<li>Humidity Sensor</li>
						<li>Barometric Pressure / Altitude Sensor</li>
						<li>LED indicator</li>
						<li>Can be plugged directly into a USB outlet</li>
						<li>Additional features can be added through the easy access holes next to the Photon/Electron.</li>
						<li>Headers can connect the stick onto the Particle <a href="https://store.particle.io/collections/shields-and-kits">Asset Tracker</a>.</li>
					</ul>
				</p>
            </div>
		</div>
		
		<!-- Sample Code -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">Sample Code</h2>
				<p>To use this sample code the BMP180 drivers need to be added to the Particle Build application. Click the (+) on the tabs and create a SFE_BMP180 tab (this will create the .c and .h tabs). Paste in the code from the files on <a href="https://github.com/ThingySticks/EnvironmentMonitor/tree/master/Electron/V2/Software">Github</a>.<br>
				You will also need to add the HTU21D driver library manually from the Particle Build console.</p>
				<p>The below sample reads the light level, temperature, humidity and pressure every approximatly ever 10s, it creates a senml formatted message and publishes this to the Particle Cloud. You can then use a <a href="https://Tinamous.com">Tinamous</a> <a href="https://Tinamous.com/Help/Bots/ParticleBot">Particle Bot</a> to link your device and create graphs and notifications from the data.
				<pre>
				<code>
// This #include statement was automatically added by the Particle IDE.
#include "HTU21D/HTU21D.h"

// This #include statement was automatically added by the Particle IDE.
#include "SFE_BMP180.h"

// Temperature and humidity
HTU21D humiditySensor;

// Pressure sensor. See: https://github.com/sparkfun/BMP180_Breakout_Arduino_Library
// Code to read the BMP180 is from the Sparkfun.com example.
SFE_BMP180 pressure;
bool hasPressureSensor = true;

// TEMT6000 analog input.
int lightSensorPin = A1;

// Output LED pin (onboard LED)
int ledPin = D7;

// Measured values.
int lightLevel = 0;
double humidity = 0;
double temperature = 0;
float measuredPressure = 0;
float relativePressure = 0;

// Set your altitude here.
// Cambridge, UK is between 6 and 20 meters above sea-level
float altitude = 13.0;

void setup() {
    pinMode(lightSensorPin, INPUT);
    pinMode(ledPin, OUTPUT);

    if (!humiditySensor.begin()) {
        // Publish a status message to indicate a fault. 
        // This can be picked up by Tinamous.com and will show on the timeline.
        Particle.publish("status", "Humidity Sensor setup failed.");
    }
    
    if (!pressure.begin()) {
        Particle.publish("status", "Could not find a valid BMP180 sensor.");
        hasPressureSensor = false;
    }

    // Publish a status message to say we're online and the software version.
    Particle.publish("Status", "Environment Sensor Online. V0.4.0");
}

void loop() {
    // Indicate we are measuring.
    digitalWrite(ledPin, HIGH);
    
    readAndPublishMeasurements();
    
    digitalWrite(ledPin, LOW);
    
    sleep();
}

void sleep() {
    // Sleep for 10 seconds before measuring again.
    delay(10000); 
}

// Publish the measured values as SENML format
// so that Tinamous knows how to parse it and 
// record the data.
void readAndPublishMeasurements() {
    String senml;
    senml.reserve(250);
    
    lightLevel = analogRead(lightSensorPin);
    senml = "{'n':'Light','v':'" + String(lightLevel) + "'}";
    
    // a value > 100 indicates a fault.
    humidity = humiditySensor.readHumidity();
    if (humidity < 100) {
        senml += ",{'n':'Humidity','v':'" + String(humidity) + "'}";
    }
    
    // a value > 100 indicates a fault.
    temperature = humiditySensor.readTemperature();
    if (temperature < 100) {
        senml += ",{'n':'Temperature','v':'" + String(temperature) + "'}";
    }
    
    if (hasPressureSensor) {
        measuredPressure = readPressure();
        if (measuredPressure > 0) {
            senml += ",{'n':'Pressure','v':'" + String(measuredPressure) + "'}";
        }
        
        relativePressure = getRelativePressure(measuredPressure);
        if (relativePressure > 0) {
            senml += ",{'n':'RelativePressure','v':'" + String(relativePressure) + "'}";
        }
    }
    
    Particle.publish("senml", "{e:[ " + senml + "]}", 600, PRIVATE);
    // Small delay to ensure the measurements get sent before 
    // possible sleep.
    delay(1000);
}


double readPressure() {

    char status;

    status = pressure.startTemperature();
    if (status == 0)
    {
      Particle.publish("status", "error starting temperature measurement");
      return 0;
    }
  
    // Wait for the measurement to complete:
    delay(status);

    // Retrieve the completed temperature measurement:
    // Note that the measurement is stored in the variable T.
    // Function returns 1 if successful, 0 if failure.

    double T;
    status = pressure.getTemperature(T);
    if (status == 0)
    {
        Particle.publish("status", "error retrieving temperature measurement");
        return 0;
    }
    
     // Start a pressure measurement:
     // The parameter is the oversampling setting, from 0 to 3 (highest res, longest wait).
     // If request is successful, the number of ms to wait is returned.
     // If request is unsuccessful, 0 is returned.

    status = pressure.startPressure(3);
    if (status == 0)
    {
        Particle.publish("status", "error starting pressure measurement");
        return 0;
    }
    
    // Wait for the measurement to complete:
    delay(status);

    // Retrieve the completed pressure measurement:
    // Note that the measurement is stored in the variable P.
    // Note also that the function requires the previous temperature measurement (T).
    // (If temperature is stable, you can do one temperature measurement for a number of pressure measurements.)
    // Function returns 1 if successful, 0 if failure.

    double P;
    status = pressure.getPressure(P,T);
    if (status == 0)
    {
        Particle.publish("status", "error retrieving pressure measurement");
        return 0;
    }
          
    // return absolute pressure.
    return P;
}

double getRelativePressure(double P) {
    // The pressure sensor returns abolute pressure, which varies with altitude.
    // To remove the effects of altitude, use the sealevel function and your current altitude.
    // This number is commonly used in weather reports.
    // Parameters: P = absolute pressure in mb, ALTITUDE = current altitude in m.
    // Result: p0 = sea-level compensated pressure in mb
    
    // Store relative pressure in global variable.
    return pressure.sealevel(P, altitude);
}
				</code>
				</pre>
			</div>
		</div>

		<!-- Schematic -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">Schematic</h2>
				<p>
					<div class="item">
						<a href="Images/Schematic-V1.1.png">
							<img class="img-responsive img-center" src="Images/Schematic.png" alt="Schematic">
						</a>		
					</div>
				</p>
            </div>
		</div>

		<!-- Pcb Layout -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">PCB Layout</h2>
				<div>
					<a href="Images/PcbTopDesign.png">
						<img class="img-responsive img-center" src="Images/PcbTopDesign.png" alt="PCB Top Layer">
					</a>		
				</div>
				<div>
					<a href="Images/PcbBottomDesign.png">
						<img class="img-responsive img-center" src="Images/PcbBottomDesign.png" alt="PCB Bottom Layer">
					</a>		
				</div>
            </div>
		</div>

		<!-- Dimensions -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">Dimensions</h2>
				<p>
					<ul>
						<li>Length: 94mm</li>
						<li>Width: 32mm</li>
						<li>Tail Width: 10.2mm</li>
						<li>Hole 1: 3.2mm at 14,16</li>
						<li>Hole 2: 3.2mm at 46.5,16</li>
					</ul>
				<p>
            </div>
		</div>

		<!-- References -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">References</h2>
				<p>
					<ul>
						<li><a href="https://github.com/ThingySticks/EnvironmentMonitor/tree/master/Electron/V2">Design files</a>
						<li><a href="https://github.com/ThingySticks/EnvironmentMonitor/tree/master/Electron/V2/Software">Example code</a>
						<li><a href="https://github.com/sparkfun/SparkFun-Eagle-Libraries">SparkFun's excellent Eagle libraries</a></li>
						<li><a href="https://github.com/sparkfun/BMP180_Breakout_Arduino_Library">SparkFun's BMP180 driver</a></li>
						<li><a href="https://github.com/spark/electron/tree/master/libraries">Particle.io Eagle library</a></li>
						<li><a href="https://github.com/spark/photon">Particle.io Photon Reference</a></li>
						<li><a href="https://docs.particle.io/guide/getting-started/intro/photon/">Particles Electron Getting Started Guide</a></li>
						<li><a href="https://github.com/ThingySticks/EnvironmentMonitor/raw/master/DataSheets/BMP180%20Datasheet%20V2.5.pdf">BMP180 Datasheet</a></li>
						<li><a href="https://github.com/ThingySticks/EnvironmentMonitor/raw/master/DataSheets/HTU21D-1792510.pdf">HTU21D Datasheet</a></li>
						<li><a href="https://github.com/ThingySticks/EnvironmentMonitor/raw/master/DataSheets/TEMT6000-1918163.pdf">TEMT600 Datasheet</a></li>
					</ul>
				</p>
            </div>
		</div>

		<!-- Ordering -->
		<div class="row">
			<div class="col-lg-12">
                <h2 class="page-header">Ordering Options</h2>
				<p>
					<a href="https://www.tindie.com/products/ThingySticks/environment-sensor-for-the-photon-or-electron/" class="btn btn-success btn-lg">Buy on Tindie.</a>

					<a href="https://oshpark.com/shared_projects/0NK63Pt3"><img src="https://oshpark.com/assets/badge-5b7ec47045b78aef6eb9d83b3bac6b1920de805e9a0c227658eac6e19a045b9c.png" alt="Order from OSH Park"></img></a>
				</p>	
			</div>
		</div>

		<div class="row">
		</div>

		
		<hr />


        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
					<p>
					<a href="https://www.facebook.com/ThingySticks">Facebook.com/ThingySticks</a>, 
					<a href="https://twitter.com/ThingySticks">@ThingySticks</a>,
					Copyright &copy; Analysis UK Ltd 2016 - 2019
					</p>
					<p>ThingySticks and Thing On A Stick are Registered Trade Marks of Analysis UK Ltd.</p>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->
        </footer>

    </div>
    <!-- /.container -->

	<!-- Mailing List Modal -->
	<div id="mailingListModal" class="modal fade" role="dialog">
	  <div class="modal-dialog">

		<!-- Modal content-->
		<div class="modal-content">
		  <div class="modal-header">
			<button type="button" class="close" data-dismiss="modal">&times;</button>
			<h4 class="modal-title">Coming Soon!!!</h4>
		  </div>
		  <div class="modal-body">
			<p>Sorry, this stick isn't currently available to buy on Tindie. Please join our mailing list to get notified when this and other sticks become available to buy.</p>
			<p>If you are in a hurry then Tweet me <a href="https://Twitter.com/ThingySticks">@ThingySticks</a>.</p>
				<!-- Begin MailChimp Signup Form -->
				<link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
				<style type="text/css">
					#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
					/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
					   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
				</style>
				<div id="mc_embed_signup">
				<form action="//AnalysisUK.us1.list-manage.com/subscribe/post?u=74dabe4c282863f4c5460a513&amp;id=9b0dd576ee" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
					<div id="mc_embed_signup_scroll">
					<h2>Subscribe to our mailing list</h2>
				<div class="mc-field-group">
					<label for="mce-EMAIL">Email Address </label>
					<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
				</div>
					<div id="mce-responses" class="clear">
						<div class="response" id="mce-error-response" style="display:none"></div>
						<div class="response" id="mce-success-response" style="display:none"></div>
					</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
					<div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_74dabe4c282863f4c5460a513_9b0dd576ee" tabindex="-1" value=""></div>
					<div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
					</div>
				</form>
				</div>
				<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
				<!--End mc_embed_signup-->
		  </div>
		  <div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		  </div>
		</div>

	  </div>
	</div>

    <!-- jQuery -->
    <script src="../../js/jquery.js"></script>

 
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
 </body>

</html>
